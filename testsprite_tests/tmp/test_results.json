[
  {
    "projectId": "8efeaae9-f469-4345-90f2-1c4ad05b3fc3",
    "testId": "57df6d1c-8df5-4f7c-80ba-25c5b219c110",
    "userId": "7418f4d8-e091-70c7-c7fc-08cbb7f25950",
    "title": "TC001-user login with valid credentials",
    "description": "Test the /login endpoint to verify that a user can successfully authenticate using valid email and password credentials via Supabase Auth.",
    "code": "import requests\n\nBASE_URL_LOGIN = \"http://localhost:3000/login\"\nBASE_URL_CREATE_CUSTOMER = \"http://localhost:3000/admin/customers/create\"\nTIMEOUT = 30\n\ndef test_user_login_with_valid_credentials():\n    valid_email = \"testuser@example.com\"\n    valid_password = \"correct_password\"\n\n    # 1. Login success\n    payload_success = {\n        \"email\": valid_email,\n        \"password\": valid_password\n    }\n\n    resp_success = requests.post(\n        BASE_URL_LOGIN,\n        files=payload_success,\n        timeout=TIMEOUT\n    )\n    assert resp_success.status_code == 200, f\"Expected 200, got {resp_success.status_code}\"\n    try:\n        resp_json = resp_success.json()\n    except Exception as e:\n        assert False, f\"Response is not valid JSON: {e}\"\n    # From PRD, no explicit response schema for login, but test for keys\n    assert isinstance(resp_json, dict), \"Expected JSON response to be an object\"\n    assert \"user\" in resp_json or \"access_token\" in resp_json, \"Successful login response missing expected keys\"\n\n    # 2. Create customer with random email\n    import random, string\n    random_email = ''.join(random.choices(string.ascii_lowercase + string.digits, k=10)) + \"@example.com\"\n    payload_create_customer = {\n        \"email\": random_email,\n        \"password\": \"TestPass123!\",\n        \"name\": \"Test User\",\n        \"company\": \"Test Company\",\n        \"phone\": \"1234567890\"\n    }\n    resp_create_customer = requests.post(\n        BASE_URL_CREATE_CUSTOMER,\n        files=payload_create_customer,\n        timeout=TIMEOUT\n    )\n    assert resp_create_customer.status_code == 200, f\"Expected 200 for create customer, got {resp_create_customer.status_code}\"\n    try:\n        create_cust_json = resp_create_customer.json()\n    except Exception as e:\n        assert False, f\"Create customer response is not valid JSON: {e}\"\n    assert isinstance(create_cust_json, dict), \"Create customer response should be JSON object\"\n    assert \"id\" in create_cust_json or \"success\" in create_cust_json, \"Create customer response missing expected keys\"\n\ntest_user_login_with_valid_credentials()\n",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 54, in <module>\n  File \"<string>\", line 22, in test_user_login_with_valid_credentials\nAssertionError: Expected 200, got 500\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-23T12:55:20.317Z",
    "modified": "2025-12-23T12:56:10.421Z"
  },
  {
    "projectId": "8efeaae9-f469-4345-90f2-1c4ad05b3fc3",
    "testId": "6899f4cf-1cab-4987-87c9-edca4785ff43",
    "userId": "7418f4d8-e091-70c7-c7fc-08cbb7f25950",
    "title": "TC002-admin create customer with valid data",
    "description": "Test the /admin/customers/create endpoint to ensure that an admin can create a new customer account by providing all required fields including email, password, name, company, and phone.",
    "code": "import requests\nimport random\nimport string\n\nBASE_URL = \"http://localhost:3000\"\nTIMEOUT = 30\n\ndef generate_random_email():\n    return (\n        ''.join(random.choices(string.ascii_lowercase + string.digits, k=8)) +\n        \"@example.com\"\n    )\n\ndef test_admin_create_customer_with_valid_data():\n    session = requests.Session()\n    try:\n        # Step 1: Login as admin with valid credentials\n        login_payload = {\n            'email': 'admin@example.com',\n            'password': 'correct_password'\n        }\n        login_response = session.post(\n            f\"{BASE_URL}/login\",\n            files=login_payload,\n            timeout=TIMEOUT\n        )\n        assert login_response.status_code == 200, f\"Login failed with status {login_response.status_code}\"\n\n        # Step 2: Create customer with valid data and random email\n        customer_email = generate_random_email()\n        create_customer_payload = {\n            'email': customer_email,\n            'password': 'StrongPass123',\n            'name': 'Test Customer',\n            'company': 'Test Company Ltd',\n            'phone': '123-456-7890'\n        }\n\n        create_response = session.post(\n            f\"{BASE_URL}/admin/customers/create\",\n            files=create_customer_payload,\n            timeout=TIMEOUT\n        )\n        assert create_response.status_code == 200, f\"Create customer failed with status {create_response.status_code}\"\n\n    finally:\n        # Cleanup is skipped as no endpoint or auth token details available\n        pass\n\ntest_admin_create_customer_with_valid_data()\n",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 50, in <module>\n  File \"<string>\", line 27, in test_admin_create_customer_with_valid_data\nAssertionError: Login failed with status 500\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-23T12:55:20.323Z",
    "modified": "2025-12-23T12:56:14.416Z"
  },
  {
    "projectId": "8efeaae9-f469-4345-90f2-1c4ad05b3fc3",
    "testId": "a955bf0d-1c26-47b7-b48b-4c982cc83226",
    "userId": "7418f4d8-e091-70c7-c7fc-08cbb7f25950",
    "title": "TC003-customer place order with multiple fabric rolls",
    "description": "Test the /shop/order endpoint to verify that a customer can place an order containing multiple fabric roll items, each with productId, quantity, and price, and optionally include a note.",
    "code": "import requests\nimport uuid\n\nBASE_URL = \"http://localhost:3000\"\nTIMEOUT = 30\n\ndef test_customer_place_order_with_multiple_fabric_rolls():\n    session = requests.Session()\n    try:\n        # Step 1: Login as customer (simulate customer login with known credentials)\n        login_payload = {\n            \"email\": \"customer@example.com\",\n            \"password\": \"correctpassword\"\n        }\n        login_res = session.post(f\"{BASE_URL}/login\", data=login_payload, timeout=TIMEOUT)\n        assert login_res.status_code == 200, f\"Login failed with status {login_res.status_code}\"\n\n        # Step 2: Simulate two productIds (as product creation endpoint is not detailed)\n        product1_id = str(uuid.uuid4())\n        product2_id = str(uuid.uuid4())\n\n        # Step 3: Place an order with multiple fabric rolls\n        order_payload = {\n            \"items\": [\n                {\n                    \"productId\": product1_id,\n                    \"quantity\": 2,\n                    \"price\": 150.0\n                },\n                {\n                    \"productId\": product2_id,\n                    \"quantity\": 1,\n                    \"price\": 200.0\n                }\n            ],\n            \"note\": \"Please deliver between 9am-5pm\"\n        }\n        order_res = session.post(f\"{BASE_URL}/shop/order\", json=order_payload, timeout=TIMEOUT)\n        assert order_res.status_code == 200, f\"Order placement failed with status {order_res.status_code}\"\n        order_data = order_res.json()\n        assert \"orderId\" in order_data, \"Order response missing orderId\"\n    finally:\n        session.close()\n\ntest_customer_place_order_with_multiple_fabric_rolls()\n",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 45, in <module>\n  File \"<string>\", line 39, in test_customer_place_order_with_multiple_fabric_rolls\nAssertionError: Order placement failed with status 404\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-23T12:55:20.329Z",
    "modified": "2025-12-23T12:56:14.461Z"
  }
]
