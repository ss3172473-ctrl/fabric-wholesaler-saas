{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/leesungjun/%EC%98%81%EC%A7%84%20%EC%9E%A5%EB%B6%80%EC%B2%98%EB%A6%AC%20%EC%9E%90%EB%8F%99%ED%99%94/src/components/ExcelMigration.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { Group, Text, useMantineTheme, useMantineColorScheme, Table, Alert, Button, Container, Title } from '@mantine/core';\nimport { Dropzone, MIME_TYPES } from '@mantine/dropzone';\nimport { IconUpload, IconX, IconFileSpreadsheet, IconAlertCircle } from '@tabler/icons-react';\nimport * as XLSX from 'xlsx';\n\n// Defined based on the user's \"Jangbu\" columns\ninterface LedgerRow {\n    Date: string; // e.g., '2025-01-15'\n    CustomerName: string; // 'Kim Fabric'\n    ItemName: string; // 'Blue Cotton 20s'\n    Quantity: number; // 50\n    Unit: string; // 'yds'\n    Price: number; // 4500\n    Total: number; // 225000\n}\n\nexport function ExcelMigration() {\n    const theme = useMantineTheme();\n    const { colorScheme } = useMantineColorScheme();\n    const [data, setData] = useState<LedgerRow[]>([]);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n\n    const handleDrop = async (files: File[]) => {\n        setLoading(true);\n        setError(null);\n        const file = files[0];\n\n        try {\n            const arrayBuffer = await file.arrayBuffer();\n            const workbook = XLSX.read(arrayBuffer, { type: 'array' });\n\n            // Assuming the first sheet is the target\n            const sheetName = workbook.SheetNames[0];\n            const worksheet = workbook.Sheets[sheetName];\n\n            // Convert to JSON\n            const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });\n\n            // Basic Parsing Logic (Assumption: Row 0 is header)\n            // We start from row 1\n            const parsedData: LedgerRow[] = [];\n\n            // Skip header (row 0)\n            for (let i = 1; i < jsonData.length; i++) {\n                const row = jsonData[i] as any[];\n                if (!row || row.length === 0) continue;\n\n                // Map columns based on index (Needs to be adjusted to actual Excel file)\n                // Example: Col 0=Date, 1=Customer, 2=Item, 3=Qty, 4=Price\n                const parsedRow: LedgerRow = {\n                    Date: row[0] || '',\n                    CustomerName: row[1] || 'Unknown',\n                    ItemName: row[2] || '',\n                    Quantity: Number(row[3]) || 0,\n                    Unit: 'yds', // Default or parsed\n                    Price: Number(row[4]) || 0,\n                    Total: (Number(row[3]) || 0) * (Number(row[4]) || 0),\n                };\n\n                if (parsedRow.CustomerName && parsedRow.ItemName) {\n                    parsedData.push(parsedRow);\n                }\n            }\n\n            setData(parsedData);\n        } catch (err) {\n            console.error(err);\n            setError('Failed to parse Excel file. Please check the format.');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <Container size=\"lg\" py=\"xl\">\n            <Title order={2} mb=\"md\">Data Migration (Excel Upload)</Title>\n            <Text c=\"dimmed\" mb=\"xl\">\n                Upload your existing \"Jangbu\" files here. The system will parse Dates, Customers, and Items.\n            </Text>\n\n            <Dropzone\n                onDrop={handleDrop}\n                onReject={(files) => setError('File invalid. Please upload .xlsx or .xls')}\n                maxSize={5 * 1024 ** 2}\n                accept={[MIME_TYPES.xlsx, MIME_TYPES.xls]}\n                loading={loading}\n                mb=\"xl\"\n            >\n                <Group justify=\"center\" gap=\"xl\" style={{ minHeight: 220, pointerEvents: 'none' }}>\n                    <Dropzone.Accept>\n                        <IconUpload\n                            size=\"3.2rem\"\n                            stroke={1.5}\n                            color={theme.colors[theme.primaryColor][colorScheme === 'dark' ? 4 : 6]}\n                        />\n                    </Dropzone.Accept>\n                    <Dropzone.Reject>\n                        <IconX\n                            size=\"3.2rem\"\n                            stroke={1.5}\n                            color={theme.colors.red[colorScheme === 'dark' ? 4 : 6]}\n                        />\n                    </Dropzone.Reject>\n                    <Dropzone.Idle>\n                        <IconFileSpreadsheet size=\"3.2rem\" stroke={1.5} />\n                    </Dropzone.Idle>\n\n                    <div>\n                        <Text size=\"xl\" inline>\n                            Drag 'ty 수정2025.xlsx' here or click to select files\n                        </Text>\n                        <Text size=\"sm\" c=\"dimmed\" inline mt={7}>\n                            Attach one file per upload. max 5mb.\n                        </Text>\n                    </div>\n                </Group>\n            </Dropzone>\n\n            {error && (\n                <Alert icon={<IconAlertCircle size=\"1rem\" />} title=\"Error\" color=\"red\" mb=\"lg\">\n                    {error}\n                </Alert>\n            )}\n\n            {data.length > 0 && (\n                <>\n                    <Group justify=\"space-between\" mb=\"xs\">\n                        <Title order={4}>Preview ({data.length} rows)</Title>\n                        <Button color=\"blue\">Confirm & Import to Database</Button>\n                    </Group>\n\n                    <Table striped highlightOnHover withTableBorder>\n                        <Table.Thead>\n                            <Table.Tr>\n                                <Table.Th>Date</Table.Th>\n                                <Table.Th>Customer</Table.Th>\n                                <Table.Th>Item</Table.Th>\n                                <Table.Th>Qty</Table.Th>\n                                <Table.Th>Price</Table.Th>\n                                <Table.Th>Total</Table.Th>\n                            </Table.Tr>\n                        </Table.Thead>\n                        <Table.Tbody>\n                            {data.slice(0, 10).map((row, index) => (\n                                <Table.Tr key={index}>\n                                    <Table.Td>{row.Date}</Table.Td>\n                                    <Table.Td>{row.CustomerName}</Table.Td>\n                                    <Table.Td>{row.ItemName}</Table.Td>\n                                    <Table.Td>{row.Quantity}</Table.Td>\n                                    <Table.Td>{row.Price.toLocaleString()} KRW</Table.Td>\n                                    <Table.Td>{row.Total.toLocaleString()} KRW</Table.Td>\n                                </Table.Tr>\n                            ))}\n                        </Table.Tbody>\n                    </Table>\n                    {data.length > 10 && <Text ta=\"center\" mt=\"sm\">...and {data.length - 10} more rows</Text>}\n                </>\n            )}\n        </Container>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 412, "column": 0}, "map": {"version":3,"sources":["file:///Users/leesungjun/%EC%98%81%EC%A7%84%20%EC%9E%A5%EB%B6%80%EC%B2%98%EB%A6%AC%20%EC%9E%90%EB%8F%99%ED%99%94/src/app/admin/migration/page.tsx"],"sourcesContent":["'use client';\n\nimport { ExcelMigration } from '@/components/ExcelMigration';\nimport { Container } from '@mantine/core';\n\nexport default function MigrationPage() {\n    return (\n        <Container size=\"xl\" py=\"xl\">\n            <ExcelMigration />\n        </Container>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAKe,SAAS;IACpB,qBACI,8OAAC,8LAAS;QAAC,MAAK;QAAK,IAAG;kBACpB,cAAA,8OAAC,sJAAc;;;;;;;;;;AAG3B"}}]
}